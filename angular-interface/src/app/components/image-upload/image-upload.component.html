<div class="image-upload-container">
  <h2>MRI Image Upload</h2>

  <div
    class="upload-zone"
    [class.active]="isDragging"
    [class.disabled]="!patientId"
    (dragover)="onDragOver($event)"
    (dragleave)="onDragLeave($event)"
    (drop)="onDrop($event)"
  >
    <ng-container *ngIf="!selectedFile && !isUploading">
      <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
        <polyline points="17 8 12 3 7 8"></polyline>
        <line x1="12" y1="3" x2="12" y2="15"></line>
      </svg>
      <p>Drag & drop MRI image here or</p>
      <input
        type="file"
        id="fileInput"
        accept="image/*"
        (change)="onFileSelected($event)"
        [disabled]="!patientId"
      >
      <label for="fileInput" [class.disabled]="!patientId">
        Browse Files
      </label>
      <p *ngIf="!patientId" class="warning">Please enter patient information first</p>
    </ng-container>

    <div *ngIf="selectedFile && !isUploading" class="selected-file">
      <div class="file-preview" *ngIf="previewUrl">
        <img [src]="previewUrl" alt="Selected MRI image preview">
      </div>
      <div class="file-info">
        <p>{{ selectedFile.name }}</p>
        <p>{{ (selectedFile.size / 1024 / 1024).toFixed(2) }} MB</p>
      </div>
      <div class="file-actions">
        <button class="cancel-btn" (click)="resetFile()">Cancel</button>
        <button class="upload-btn" (click)="uploadFile()">Analyze Image</button>
      </div>
    </div>

    <div *ngIf="isUploading" class="upload-progress">
      <div class="spinner"></div>
      <p>Processing image, please wait...</p>
    </div>
  </div>
</div>
